<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Wiskoro Chatbot - Je eigen wiskunde GOAT">
    <title>Wiskoro Chatbot</title>
    <link rel="preconnect" href="https://rsms.me">
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <style>
        :root {
            color-scheme: light dark;
            --bg-color-light: #f9f9f9;
            --text-color-light: #333;
            --bg-color-dark: #1e1e1e;
            --text-color-dark: #f5f5f5;
            --chat-bg-light: #ffffff;
            --chat-bg-dark: #2a2a2a;
            --border-color-light: #ddd;
            --border-color-dark: #444;
            --button-color: #007aff;
            --button-hover: #005ecb;
            --focus-outline: #4a9eff;
        }

        /* Reset en basis stijlen */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            line-height: 1.5;
            text-align: center;
            background-color: var(--bg-color-light);
            color: var(--text-color-light);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        @media (prefers-color-scheme: dark) {
            body {
                background-color: var(--bg-color-dark);
                color: var(--text-color-dark);
            }
        }

        #chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            max-width: 800px;
            margin: 0 auto;
            padding: 1rem;
            height: 100vh;
            background-color: var(--chat-bg-light);
        }

        #chat-box {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            scroll-behavior: smooth;
        }

        .message {
            margin: 0.5rem 0;
            padding: 0.75rem 1rem;
            border-radius: 1rem;
            max-width: 80%;
            word-wrap: break-word;
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(0.5rem); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        .user {
            background-color: var(--button-color);
            color: #fff;
            margin-left: auto;
        }

        .bot {
            background-color: #f1f1f1;
            color: #000;
            margin-right: auto;
        }

        .input-container {
            display: flex;
            gap: 0.75rem;
            padding: 1rem;
            background-color: var(--chat-bg-light);
        }

        #user-input {
            flex: 1;
            padding: 0.75rem 1rem;
            border-radius: 1rem;
            border: 2px solid var(--border-color-light);
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        #user-input:focus {
            outline: none;
            border-color: var(--focus-outline);
            box-shadow: 0 0 0 2px rgba(74, 158, 255, 0.2);
        }

        button {
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            border-radius: 1rem;
            border: none;
            background-color: var(--button-color);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
        }

        button:hover {
            background-color: var(--button-hover);
        }

        button:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--focus-outline);
        }

        button:active {
            transform: scale(0.98);
        }

        @media (max-width: 480px) {
            .message {
                max-width: 90%;
            }

            .input-container {
                padding: 0.75rem;
            }

            button {
                padding: 0.75rem 1rem;
            }
        }
    </style>
</head>
<body>
    <div id="chat-container">
        <div id="chat-box" role="log" aria-live="polite"></div>
        <form class="input-container" onsubmit="handleSubmit(event)">
            <input 
                type="text" 
                id="user-input" 
                placeholder="Drop je vraag hier, bro..." 
                aria-label="Je vraag"
                autocomplete="off"
            >
            <button type="submit" id="send-button">Gooi eruit</button>
        </form>
    </div>

    <script>
        const backendUrl = "https://wiskoro-backend.up.railway.app/chat";
        const buttonTexts = ["Gooi eruit", "Drop die vraag", "Spit die wiskunde", "Knallen maar", "Tik die som"];
        const welcomeMessages = [
            "Faka, welkom bij Wiskoro! ðŸ”¥ Tijd om je wiskunde skills te boosten!", 
            "Yo! Klaar om wiskunde te ownen? Ik fix die uitleg voor je! ðŸ“š", 
            "Ey, jij daar! Pak je sommen, want we gaan gas geven op wiskunde! ðŸš€", 
            "Bro, geen stress! Met Wiskoro maak jij wiskunde je playground!", 
            "Let's go! Hier leer je wiskunde met de meeste sauce! ðŸ§ ðŸ’¯",
            "Skeer op wiskunde? Niet meer! Tijd om te shinen met Wiskoro! âœ¨",
            "HÃ© legend! Vandaag is de dag dat je wiskunde mastert! ðŸ‘‘",
            "Wiskunde is geen drill, maar jij gaat het killen! ðŸ’ªðŸ”¥",
            "Yo, yo, yo! Pak je brein en let's gooo! ðŸ§ âš¡",
            "Geen paniek, wiskunde wordt easy met Wiskoro! ðŸ˜Ž"
        ];
        
        const sendButton = document.getElementById("send-button");
        const chatBox = document.getElementById("chat-box");
        const userInput = document.getElementById("user-input");
        let isProcessing = false;

        function getRandomItem(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        function updateButtonText() {
            sendButton.textContent = getRandomItem(buttonTexts);
        }
        
        function addMessage(content, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.textContent = content;
            chatBox.appendChild(messageDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        }
        
        function showWelcomeMessage() {
            addMessage(getRandomItem(welcomeMessages), 'bot');
        }

        async function handleSubmit(event) {
            event.preventDefault();
            
            const message = userInput.value.trim();
            if (!message || isProcessing) return;

            isProcessing = true;
            sendButton.disabled = true;
            
            try {
                addMessage(message, 'user');
                userInput.value = '';
                updateButtonText();

                const response = await fetch(backendUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message })
                });

                if (!response.ok) {
                    throw new Error('Netwerk response was niet ok');
                }

                const data = await response.json();
                addMessage(data.response || 'Sorry, er ging iets mis. Probeer het nog een keer!', 'bot');
            } catch (error) {
                console.error('Error:', error);
                addMessage('Oeps! Er ging iets mis. Check je internet en probeer het nog een keer!', 'bot');
            } finally {
                isProcessing = false;
                sendButton.disabled = false;
                userInput.focus();
            }
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            showWelcomeMessage();
            userInput.focus();
        });

        // Voorkom dubbele submits bij enter Ã©n button click
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendButton.click();
            }
        });
    </script>
</body>
</html>
